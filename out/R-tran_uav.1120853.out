Job 1120853: Running on node(s) kersey
Job 1120853: Started at 2024-07-09 16:57:26+0200
Monitor this job here: http://monitoring.pegasus.kl.dfki.de/d/slurm-job-details/job-details?var-jobid=1120853&from=1720537046000
srun: jobinfo: version v1.0.0
Job 1120853: Running on node(s) kersey
Job 1120853: Started at 2024-07-09 16:57:26+0200
Monitor this job here: http://monitoring.pegasus.kl.dfki.de/d/slurm-job-details/job-details?var-jobid=1120853&from=1720537046000
Job 1120853: creating container for /netscratch/jsingh/pyskl7.sqsh
Job 1120853: creating container for /netscratch/jsingh/pyskl7.sqsh took 47.6 seconds
2024-07-09 16:58:19,305 - pyskl - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.11 (default, Jul 27 2021, 14:32:16) [GCC 7.5.0]
CUDA available: True
GPU 0,1,2,3: Quadro RTX 6000
CUDA_HOME: /usr/local/cuda
NVCC: Cuda compilation tools, release 11.1, V11.1.105
GCC: gcc (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0
PyTorch: 1.11.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.12.0
OpenCV: 4.10.0
MMCV: 1.5.0
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.3
pyskl: 0.1.0+99609cf
------------------------------------------------------------

2024-07-09 16:58:21,882 - pyskl - INFO - Config: model = dict(
    type='Recognizer3D',
    backbone=dict(
        type='ResNet3dSlowOnly',
        in_channels=17,
        base_channels=32,
        num_stages=3,
        out_indices=(2, ),
        stage_blocks=(4, 6, 3),
        conv1_stride=(1, 1),
        pool1_stride=(1, 1),
        inflate=(0, 1, 1),
        spatial_strides=(2, 2, 2),
        temporal_strides=(1, 1, 2)),
    cls_head=dict(type='I3DHead', in_channels=512, num_classes=6, dropout=0.5),
    test_cfg=dict(average_clips='prob'))
dataset_type = 'PoseDataset'
ann_file = '/netscratch/jsingh/thesis/datasets/AUTHUAVGestureDatasetVideos_fps-15/uavgesture_annos_hrnet.pkl'
left_kp = [1, 3, 5, 7, 9, 11, 13, 15]
right_kp = [2, 4, 6, 8, 10, 12, 14, 16]
skeletons = [[0, 5], [0, 6], [5, 7], [7, 9], [6, 8], [8, 10], [5, 11],
             [11, 13], [13, 15], [6, 12], [12, 14], [14, 16], [0, 1], [0, 2],
             [1, 3], [2, 4], [11, 12]]
left_limb = [0, 2, 3, 6, 7, 8, 12, 14]
right_limb = [1, 4, 5, 9, 10, 11, 13, 15]
train_pipeline = [
    dict(type='UniformSampleFrames', clip_len=48),
    dict(type='PoseDecode'),
    dict(type='PoseCompact', hw_ratio=1.0, allow_imgpad=True),
    dict(type='Resize', scale=(-1, 64)),
    dict(type='RandomResizedCrop', area_range=(0.56, 1.0)),
    dict(type='Resize', scale=(56, 56), keep_ratio=False),
    dict(
        type='Flip',
        flip_ratio=0.5,
        left_kp=[1, 3, 5, 7, 9, 11, 13, 15],
        right_kp=[2, 4, 6, 8, 10, 12, 14, 16]),
    dict(
        type='GeneratePoseTarget',
        with_kp=False,
        with_limb=True,
        skeletons=[[0, 5], [0, 6], [5, 7], [7, 9], [6, 8], [8, 10], [5, 11],
                   [11, 13], [13, 15], [6, 12], [12, 14], [14, 16], [0, 1],
                   [0, 2], [1, 3], [2, 4], [11, 12]]),
    dict(type='FormatShape', input_format='NCTHW_Heatmap'),
    dict(type='Collect', keys=['imgs', 'label'], meta_keys=[]),
    dict(type='ToTensor', keys=['imgs', 'label'])
]
val_pipeline = [
    dict(type='UniformSampleFrames', clip_len=48, num_clips=1),
    dict(type='PoseDecode'),
    dict(type='PoseCompact', hw_ratio=1.0, allow_imgpad=True),
    dict(type='Resize', scale=(64, 64), keep_ratio=False),
    dict(
        type='GeneratePoseTarget',
        with_kp=False,
        with_limb=True,
        skeletons=[[0, 5], [0, 6], [5, 7], [7, 9], [6, 8], [8, 10], [5, 11],
                   [11, 13], [13, 15], [6, 12], [12, 14], [14, 16], [0, 1],
                   [0, 2], [1, 3], [2, 4], [11, 12]]),
    dict(type='FormatShape', input_format='NCTHW_Heatmap'),
    dict(type='Collect', keys=['imgs', 'label'], meta_keys=[]),
    dict(type='ToTensor', keys=['imgs'])
]
test_pipeline = [
    dict(type='UniformSampleFrames', clip_len=48, num_clips=10),
    dict(type='PoseDecode'),
    dict(type='PoseCompact', hw_ratio=1.0, allow_imgpad=True),
    dict(type='Resize', scale=(64, 64), keep_ratio=False),
    dict(
        type='GeneratePoseTarget',
        with_kp=False,
        with_limb=True,
        skeletons=[[0, 5], [0, 6], [5, 7], [7, 9], [6, 8], [8, 10], [5, 11],
                   [11, 13], [13, 15], [6, 12], [12, 14], [14, 16], [0, 1],
                   [0, 2], [1, 3], [2, 4], [11, 12]],
        double=True,
        left_kp=[1, 3, 5, 7, 9, 11, 13, 15],
        right_kp=[2, 4, 6, 8, 10, 12, 14, 16],
        left_limb=[0, 2, 3, 6, 7, 8, 12, 14],
        right_limb=[1, 4, 5, 9, 10, 11, 13, 15]),
    dict(type='FormatShape', input_format='NCTHW_Heatmap'),
    dict(type='Collect', keys=['imgs', 'label'], meta_keys=[]),
    dict(type='ToTensor', keys=['imgs'])
]
data = dict(
    videos_per_gpu=32,
    workers_per_gpu=4,
    test_dataloader=dict(videos_per_gpu=1),
    train=dict(
        type='RepeatDataset',
        times=10,
        dataset=dict(
            type='PoseDataset',
            ann_file=
            '/netscratch/jsingh/thesis/datasets/AUTHUAVGestureDatasetVideos_fps-15/uavgesture_annos_hrnet.pkl',
            split='train',
            pipeline=[
                dict(type='UniformSampleFrames', clip_len=48),
                dict(type='PoseDecode'),
                dict(type='PoseCompact', hw_ratio=1.0, allow_imgpad=True),
                dict(type='Resize', scale=(-1, 64)),
                dict(type='RandomResizedCrop', area_range=(0.56, 1.0)),
                dict(type='Resize', scale=(56, 56), keep_ratio=False),
                dict(
                    type='Flip',
                    flip_ratio=0.5,
                    left_kp=[1, 3, 5, 7, 9, 11, 13, 15],
                    right_kp=[2, 4, 6, 8, 10, 12, 14, 16]),
                dict(
                    type='GeneratePoseTarget',
                    with_kp=False,
                    with_limb=True,
                    skeletons=[[0, 5], [0, 6], [5, 7], [7, 9], [6, 8], [8, 10],
                               [5, 11], [11, 13], [13, 15], [6, 12], [12, 14],
                               [14, 16], [0, 1], [0, 2], [1, 3], [2, 4],
                               [11, 12]]),
                dict(type='FormatShape', input_format='NCTHW_Heatmap'),
                dict(type='Collect', keys=['imgs', 'label'], meta_keys=[]),
                dict(type='ToTensor', keys=['imgs', 'label'])
            ])),
    val=dict(
        type='PoseDataset',
        ann_file=
        '/netscratch/jsingh/thesis/datasets/AUTHUAVGestureDatasetVideos_fps-15/uavgesture_annos_hrnet.pkl',
        split='test',
        pipeline=[
            dict(type='UniformSampleFrames', clip_len=48, num_clips=1),
            dict(type='PoseDecode'),
            dict(type='PoseCompact', hw_ratio=1.0, allow_imgpad=True),
            dict(type='Resize', scale=(64, 64), keep_ratio=False),
            dict(
                type='GeneratePoseTarget',
                with_kp=False,
                with_limb=True,
                skeletons=[[0, 5], [0, 6], [5, 7], [7, 9], [6, 8], [8, 10],
                           [5, 11], [11, 13], [13, 15], [6, 12], [12, 14],
                           [14, 16], [0, 1], [0, 2], [1, 3], [2, 4], [11,
                                                                      12]]),
            dict(type='FormatShape', input_format='NCTHW_Heatmap'),
            dict(type='Collect', keys=['imgs', 'label'], meta_keys=[]),
            dict(type='ToTensor', keys=['imgs'])
        ]),
    test=dict(
        type='PoseDataset',
        ann_file=
        '/netscratch/jsingh/thesis/datasets/AUTHUAVGestureDatasetVideos_fps-15/uavgesture_annos_hrnet.pkl',
        split='test',
        pipeline=[
            dict(type='UniformSampleFrames', clip_len=48, num_clips=10),
            dict(type='PoseDecode'),
            dict(type='PoseCompact', hw_ratio=1.0, allow_imgpad=True),
            dict(type='Resize', scale=(64, 64), keep_ratio=False),
            dict(
                type='GeneratePoseTarget',
                with_kp=False,
                with_limb=True,
                skeletons=[[0, 5], [0, 6], [5, 7], [7, 9], [6, 8], [8, 10],
                           [5, 11], [11, 13], [13, 15], [6, 12], [12, 14],
                           [14, 16], [0, 1], [0, 2], [1, 3], [2, 4], [11, 12]],
                double=True,
                left_kp=[1, 3, 5, 7, 9, 11, 13, 15],
                right_kp=[2, 4, 6, 8, 10, 12, 14, 16],
                left_limb=[0, 2, 3, 6, 7, 8, 12, 14],
                right_limb=[1, 4, 5, 9, 10, 11, 13, 15]),
            dict(type='FormatShape', input_format='NCTHW_Heatmap'),
            dict(type='Collect', keys=['imgs', 'label'], meta_keys=[]),
            dict(type='ToTensor', keys=['imgs'])
        ]))
optimizer = dict(type='SGD', lr=0.4, momentum=0.9, weight_decay=0.0003)
optimizer_config = dict(grad_clip=dict(max_norm=40, norm_type=2))
lr_config = dict(policy='CosineAnnealing', by_epoch=False, min_lr=0)
total_epochs = 24
checkpoint_config = dict(interval=1)
evaluation = dict(
    interval=1, metrics=['top_k_accuracy', 'mean_class_accuracy'], topk=(1, 5))
log_config = dict(interval=20, hooks=[dict(type='TextLoggerHook')])
log_level = 'INFO'
work_dir = './work_dirs/posec3d/slowonly_r50_ntu60_xsub/limb_uav'
dist_params = dict(backend='nccl')
gpu_ids = range(0, 1)

2024-07-09 16:58:21,883 - pyskl - INFO - Set random seed to 2053542661, deterministic: False
2024-07-09 16:58:22,126 - pyskl - INFO - 1932 videos remain after valid thresholding
2024-07-09 16:58:27,319 - pyskl - INFO - 459 videos remain after valid thresholding
2024-07-09 16:58:27,319 - pyskl - INFO - Start running, host: jsingh@kersey, work_dir: /home/jsingh/projects/thesis/code/pyskl_thesis/work_dirs/posec3d/slowonly_r50_ntu60_xsub/limb_uav
2024-07-09 16:58:27,319 - pyskl - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) CosineAnnealingLrUpdaterHook       
(NORMAL      ) CheckpointHook                     
(NORMAL      ) DistEvalHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) CosineAnnealingLrUpdaterHook       
(NORMAL      ) DistSamplerSeedHook                
(NORMAL      ) DistEvalHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) CosineAnnealingLrUpdaterHook       
(NORMAL      ) DistEvalHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) DistEvalHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) DistEvalHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(NORMAL      ) DistSamplerSeedHook                
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2024-07-09 16:58:27,320 - pyskl - INFO - workflow: [('train', 1)], max: 24 epochs
2024-07-09 16:58:27,320 - pyskl - INFO - Checkpoints will be saved to /home/jsingh/projects/thesis/code/pyskl_thesis/work_dirs/posec3d/slowonly_r50_ntu60_xsub/limb_uav by HardDiskBackend.
[W reducer.cpp:1289] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
2024-07-09 16:59:11,737 - pyskl - INFO - Epoch [1][20/604]	lr: 4.000e-01, eta: 8:55:47, time: 2.221, data_time: 1.152, memory: 18980, top1_acc: 0.2094, top5_acc: 0.8391, loss_cls: 2.4499, loss: 2.4499, grad_norm: 1.7991
2024-07-09 16:59:40,472 - pyskl - INFO - Epoch [1][40/604]	lr: 4.000e-01, eta: 7:20:36, time: 1.437, data_time: 0.476, memory: 18980, top1_acc: 0.1875, top5_acc: 0.8844, loss_cls: 1.8294, loss: 1.8294, grad_norm: 0.4113
2024-07-09 17:00:10,127 - pyskl - INFO - Epoch [1][60/604]	lr: 4.000e-01, eta: 6:52:14, time: 1.483, data_time: 0.518, memory: 18980, top1_acc: 0.2219, top5_acc: 0.9187, loss_cls: 1.7780, loss: 1.7780, grad_norm: 0.3302
2024-07-09 17:00:39,016 - pyskl - INFO - Epoch [1][80/604]	lr: 4.000e-01, eta: 6:35:31, time: 1.444, data_time: 0.481, memory: 18980, top1_acc: 0.2281, top5_acc: 0.9156, loss_cls: 1.7830, loss: 1.7830, grad_norm: 0.2963
2024-07-09 17:01:09,257 - pyskl - INFO - Epoch [1][100/604]	lr: 4.000e-01, eta: 6:28:32, time: 1.512, data_time: 0.535, memory: 18980, top1_acc: 0.2484, top5_acc: 0.8781, loss_cls: 1.7652, loss: 1.7652, grad_norm: 0.2914
2024-07-09 17:01:38,506 - pyskl - INFO - Epoch [1][120/604]	lr: 3.999e-01, eta: 6:21:43, time: 1.462, data_time: 0.502, memory: 18980, top1_acc: 0.2578, top5_acc: 0.8984, loss_cls: 1.7860, loss: 1.7860, grad_norm: 0.2965
2024-07-09 17:02:07,450 - pyskl - INFO - Epoch [1][140/604]	lr: 3.999e-01, eta: 6:16:10, time: 1.446, data_time: 0.476, memory: 18980, top1_acc: 0.2344, top5_acc: 0.9000, loss_cls: 1.7569, loss: 1.7569, grad_norm: 0.2831
2024-07-09 17:02:35,434 - pyskl - INFO - Epoch [1][160/604]	lr: 3.999e-01, eta: 6:10:30, time: 1.400, data_time: 0.437, memory: 18980, top1_acc: 0.3203, top5_acc: 0.9109, loss_cls: 1.6665, loss: 1.6665, grad_norm: 0.3744
2024-07-09 17:03:05,178 - pyskl - INFO - Epoch [1][180/604]	lr: 3.998e-01, eta: 6:08:18, time: 1.487, data_time: 0.515, memory: 18980, top1_acc: 0.3531, top5_acc: 0.9313, loss_cls: 1.6488, loss: 1.6488, grad_norm: 0.4491
2024-07-09 17:03:34,529 - pyskl - INFO - Epoch [1][200/604]	lr: 3.998e-01, eta: 6:05:59, time: 1.467, data_time: 0.504, memory: 18980, top1_acc: 0.3500, top5_acc: 0.9406, loss_cls: 1.6033, loss: 1.6033, grad_norm: 0.4364
2024-07-09 17:04:03,077 - pyskl - INFO - Epoch [1][220/604]	lr: 3.998e-01, eta: 6:03:07, time: 1.427, data_time: 0.453, memory: 18980, top1_acc: 0.3422, top5_acc: 0.9250, loss_cls: 1.5976, loss: 1.5976, grad_norm: 0.4506
2024-07-09 17:04:31,767 - pyskl - INFO - Epoch [1][240/604]	lr: 3.997e-01, eta: 6:00:47, time: 1.435, data_time: 0.467, memory: 18980, top1_acc: 0.3891, top5_acc: 0.9469, loss_cls: 1.4634, loss: 1.4634, grad_norm: 0.4314
2024-07-09 17:05:00,573 - pyskl - INFO - Epoch [1][260/604]	lr: 3.997e-01, eta: 5:58:51, time: 1.440, data_time: 0.469, memory: 18980, top1_acc: 0.3766, top5_acc: 0.9328, loss_cls: 1.5176, loss: 1.5176, grad_norm: 0.4687
2024-07-09 17:05:31,303 - pyskl - INFO - Epoch [1][280/604]	lr: 3.996e-01, eta: 5:58:46, time: 1.537, data_time: 0.550, memory: 18980, top1_acc: 0.3781, top5_acc: 0.9484, loss_cls: 1.5054, loss: 1.5054, grad_norm: 0.4385
2024-07-09 17:06:00,371 - pyskl - INFO - Epoch [1][300/604]	lr: 3.996e-01, eta: 5:57:18, time: 1.453, data_time: 0.487, memory: 18980, top1_acc: 0.3484, top5_acc: 0.9375, loss_cls: 1.5891, loss: 1.5891, grad_norm: 0.4431
2024-07-09 17:06:28,905 - pyskl - INFO - Epoch [1][320/604]	lr: 3.995e-01, eta: 5:55:33, time: 1.427, data_time: 0.455, memory: 18980, top1_acc: 0.3750, top5_acc: 0.9531, loss_cls: 1.4734, loss: 1.4734, grad_norm: 0.3656
Traceback (most recent call last):
  File "tools/train.py", line 167, in <module>
    main()
  File "tools/train.py", line 159, in main
    train_model(model, datasets, cfg, validate=args.validate, test=test_option, timestamp=timestamp, meta=meta)
  File "/workspace/pyskl/pyskl/apis/train.py", line 144, in train_model
    runner.run(data_loaders, cfg.workflow, cfg.total_epochs)
  File "/root/miniconda3/envs/pys/lib/python3.7/site-packages/mmcv/runner/epoch_based_runner.py", line 127, in run
    epoch_runner(data_loaders[i], **kwargs)
  File "/root/miniconda3/envs/pys/lib/python3.7/site-packages/mmcv/runner/epoch_based_runner.py", line 51, in train
    self.call_hook('after_train_iter')
  File "/root/miniconda3/envs/pys/lib/python3.7/site-packages/mmcv/runner/base_runner.py", line 309, in call_hook
    getattr(hook, fn_name)(self)
  File "/root/miniconda3/envs/pys/lib/python3.7/site-packages/mmcv/runner/hooks/logger/base.py", line 153, in after_train_iter
    self.log(runner)
  File "/root/miniconda3/envs/pys/lib/python3.7/site-packages/mmcv/runner/hooks/logger/text.py", line 235, in log
    self._dump_log(log_dict, runner)
  File "/root/miniconda3/envs/pys/lib/python3.7/site-packages/mmcv/runner/hooks/logger/text.py", line 192, in _dump_log
    with open(self.json_log_path, 'a+') as f:
FileNotFoundError: [Errno 2] No such file or directory: '/home/jsingh/projects/thesis/code/pyskl_thesis/work_dirs/posec3d/slowonly_r50_ntu60_xsub/limb_uav/20240709_165819.log.json'
srun: error: kersey: task 0: Exited with exit code 1
srun: Terminating StepId=1120853.0
